<!DOCTYPE html>
<html>
  <head>
    <title>Change Password</title>
    <script>
      const memberName = sessionStorage.getItem("memberName");
      window.onload = function () {
        document
          .querySelector("form")
          .addEventListener("submit", function (event) {
            event.preventDefault();

            const currentPassword =
              document.getElementById("currentPassword").value;
            const newPassword = document.getElementById("newPassword").value;
            const confirmPassword =
              document.getElementById("confirmPassword").value;

            if (newPassword !== confirmPassword) {
              alert("New password and confirm password do not match!");
              return;
            }
            fetch("http://localhost:5000/v1/auth/changePassword", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                oldPassword: currentPassword,
                newPassword: newPassword,
                memberName: memberName,
              }),
            })
              .then((response) => {
                if (response.status === 200) {
                  alert("Password changed successfully");
                  window.location.href = "/";
                } else {
                  alert("Error changing password");
                }
              })
              .catch((error) => {
                console.error("Error:", error);
              });
          });
      };
    </script>
  </head>
  <body>
    <h1>Change Password</h1>
    <form action="/change-password" method="POST">
      <label for="currentPassword">Current Password:</label>
      <input
        type="password"
        id="currentPassword"
        name="currentPassword"
        required
      /><br /><br />

      <label for="newPassword">New Password:</label>
      <input
        type="password"
        id="newPassword"
        name="newPassword"
        required
      /><br /><br />

      <label for="confirmPassword">Confirm Password:</label>
      <input
        type="password"
        id="confirmPassword"
        name="confirmPassword"
        required
      /><br /><br />

      <button type="submit">Change Password</button>
    </form>
  </body>
</html>
